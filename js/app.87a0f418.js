(function(e){function t(t){for(var n,r,i=t[0],s=t[1],u=t[2],l=0,f=[];l<i.length;l++)r=i[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);h&&h(t);while(f.length)f.shift()();return c.push.apply(c,u||[]),o()}function o(){for(var e,t=0;t<c.length;t++){for(var o=c[t],n=!0,r=1;r<o.length;r++){var i=o[r];0!==a[i]&&(n=!1)}n&&(c.splice(t--,1),e=s(s.s=o[0]))}return e}var n={},r={app:0},a={app:0},c=[];function i(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-120fab18":"f986af6c"}[e]+".js"}function s(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.e=function(e){var t=[],o={"chunk-120fab18":1};r[e]?t.push(r[e]):0!==r[e]&&o[e]&&t.push(r[e]=new Promise((function(t,o){for(var n="css/"+({}[e]||e)+"."+{"chunk-120fab18":"2c8d31ba"}[e]+".css",a=s.p+n,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var u=c[i],l=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(l===n||l===a))return t()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){u=f[i],l=u.getAttribute("data-href");if(l===n||l===a)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var n=t&&t.target&&t.target.src||a,c=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=n,delete r[e],h.parentNode.removeChild(h),o(c)},h.href=a;var m=document.getElementsByTagName("head")[0];m.appendChild(h)})).then((function(){r[e]=0})));var n=a[e];if(0!==n)if(n)t.push(n[2]);else{var c=new Promise((function(t,o){n=a[e]=[t,o]}));t.push(n[2]=c);var u,l=document.createElement("script");l.charset="utf-8",l.timeout=120,s.nc&&l.setAttribute("nonce",s.nc),l.src=i(e);var f=new Error;u=function(t){l.onerror=l.onload=null,clearTimeout(h);var o=a[e];if(0!==o){if(o){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",f.name="ChunkLoadError",f.type=n,f.request=r,o[1](f)}a[e]=void 0}};var h=setTimeout((function(){u({type:"timeout",target:l})}),12e4);l.onerror=l.onload=u,document.head.appendChild(l)}return Promise.all(t)},s.m=e,s.c=n,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(s.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(o,n,function(t){return e[t]}.bind(null,n));return o},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/SmogDetecter/",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=t,u=u.slice();for(var f=0;f<u.length;f++)t(u[f]);var h=l;c.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("56d7")},"31a8":function(e,t,o){},"36b2":function(e,t,o){"use strict";o.d(t,"a",(function(){return r}));o("d3b7");var n={200:"请求成功",204:"无数据",400:"参数错误",401:"认证失败",402:"超过访问次数",403:"无权限",404:"数据或地区不存在",429:"每分钟访问次数受限",500:"无响应"},r=function(e,t){return new Promise((function(o,r){var a=new XMLHttpRequest;null===a&&r(new Error("Browser does not support XMLHttpRequest!")),a.onload=function(){try{var e=JSON.parse(a.responseText);"200"===e.code?o(e):r(new Error("API return an error("+e.code+"): "+n[e.code]))}catch(t){r(t)}},a.onerror=function(){r(new Error("Fail to call API"))};var c="?";for(var i in t)c+=i+"="+encodeURIComponent(t[i])+"&";a.open("GET",e+c),a.setRequestHeader("Accept-Language","*"),a.send()}))}},"3a80":function(e,t,o){"use strict";o("79aa")},"56d7":function(e,t,o){"use strict";o.r(t);o("e260"),o("e6cf"),o("cca6"),o("a79d");var n=o("7a23");function r(e,t){var o=Object(n["resolveComponent"])("router-view");return Object(n["openBlock"])(),Object(n["createBlock"])(o)}o("58f3");const a={};a.render=r;var c=a,i=(o("d3b7"),o("3ca3"),o("ddb0"),o("6c02")),s=Object(n["withScopeId"])("data-v-afe3d07a");Object(n["pushScopeId"])("data-v-afe3d07a");var u={class:"home"},l={class:"background"},f={class:"gradient"},h={class:"main-container"},m={class:"middle-container"},d={class:"temperature-container"},p={class:"temperature-number"},g=Object(n["createVNode"])("div",{class:"temperature-sign"}," ℃ ",-1),b={class:"middle-weather-container"},v={class:"weather-text"},y={class:"bottom-container"},I={class:"tody-aoi"},w={class:"bottom-container-list"};Object(n["popScopeId"])();var O=s((function(e,t,o,r,a,c){var i=Object(n["resolveComponent"])("city-component"),s=Object(n["resolveComponent"])("weather-icon"),O=Object(n["resolveComponent"])("future-weather-info-item");return Object(n["openBlock"])(),Object(n["createBlock"])("div",u,[Object(n["createVNode"])("div",l,[Object(n["createVNode"])("div",f,[Object(n["createVNode"])("div",h,[Object(n["createVNode"])(i),Object(n["createVNode"])("div",m,[Object(n["createVNode"])("div",d,[Object(n["createVNode"])("div",p,Object(n["toDisplayString"])(a.weather.feelsLike),1),g]),Object(n["createVNode"])("div",b,[Object(n["createVNode"])(s,{icon:a.weather.icon},null,8,["icon"]),Object(n["createVNode"])("div",v,Object(n["toDisplayString"])(a.weather.text),1)])]),Object(n["createVNode"])("div",y,[Object(n["createVNode"])("div",I,"空气指数"+Object(n["toDisplayString"])(a.air.aqi)+" "+Object(n["toDisplayString"])(a.air.category),1),Object(n["createVNode"])("div",w,[(Object(n["openBlock"])(!0),Object(n["createBlock"])(n["Fragment"],null,Object(n["renderList"])(a.futureInfo,(function(e){return Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:e,text:e.text,maxTemp:e.maxTemp,minTemp:e.minTemp,dayIcon:e.dayIcon,nightIcon:e.nightIcon},null,8,["text","maxTemp","minTemp","dayIcon","nightIcon"])})),128))]),Object(n["createVNode"])("div",{class:"info-button",onClick:t[1]||(t[1]=function(t){return e.$router.push("/info")})},"天气详情")])])])])])})),j=o("b85c"),S=Object(n["withScopeId"])("data-v-0715ea3e"),k=S((function(e,t,o,r,a,c){return Object(n["openBlock"])(),Object(n["createBlock"])("div",{class:"city-component",onClick:t[1]||(t[1]=function(){return c.relocate&&c.relocate.apply(c,arguments)})},Object(n["toDisplayString"])(a.cityName),1)})),C=(o("b0c0"),o("99af"),o("36b2")),N={name:"CityComponent",data:function(){return{cityName:"未知城市",geolocationTimeStamp:0,allowRelocate:!0}},mounted:function(){""===this.$store.state.location?(this.allowRelocate=!1,this.getLocationPos()):null===this.$store.state.cityInfo?this.getCityInfo():this.cityName=this.$store.state.cityInfo.name},unmounted:function(){},methods:{relocate:function(){this.allowRelocate&&this.getLocationPos()},getLocationPos:function(){var e=this;this.cityName="正在获取城市...",this.allowRelocate=!1;var t=this;setTimeout((function(){navigator.geolocation.getCurrentPosition((function(t){console.log("yes: "),console.log(t);try{e.onLocationDetected(t)}catch(o){console.error(o)}}),(function(e){var o={1:"位置服务拒绝",2:"获取不到位置信息",3:"超时",4:"未知错误"};console.error("Can't get the location: "),console.error(e.code),t.cityName="尝试基于IP获取城市...",t.$message({message:"无法通过位置服务获取当前位置。"+"[".concat(e.code,"]: ").concat(o[e.code]),type:"warning",duration:3e3}),t.getCityNameByIP()}),{enableHighAccuracy:!1,timeout:1e4})}),0)},onLocationDetected:function(e){this.geolocationTimeStamp>e.timestamp||(this.allowRelocate=!0,this.geolocationTimeStamp=e.timestamp,this.$store.commit("setLocation",String(e.coords.longitude)+","+String(e.coords.latitude)),this.getCityInfo())},getCityNameByIP:function(){var e=this,t=this;Object(C["a"])("https://mc.raiix.com:8082/api/v1/mycity").then((function(o){console.log("ip: "),console.log(o),e.allowRelocate=!0,t.$store.commit("setLocation",o.locationID),t.getCityInfo()})).catch((function(e){console.error(e),t.$message({message:"无法通过IP获取城市信息。"+e,type:"error",duration:1e4,showClose:!0}),t.allowRelocate=!0,t.cityName="获取位置失败"}))},getCityInfo:function(){var e=this;Object(C["a"])("https://geoapi.qweather.com/v2/city/lookup",{location:this.$store.state.location,key:this.$store.state.key}).then((function(t){t.location.length>0?(e.cityName=t.location[0].name,e.$store.commit("setCityInfo",t.location[0])):(console.error("Unkown location."),e.$message({message:"当前位置不知道是哪。",type:"warning",duration:1e4,showClose:!0}),e.cityName="未知城市",e.$store.commit("clearCityInfo"))})).catch((function(t){console.error("Fail to get city info."+t),e.$message({message:"无法获取当前城市信息。"+t,type:"error",duration:1e4,showClose:!0}),e.cityName="未知城市"}))}}};o("bf5e");N.render=k,N.__scopeId="data-v-0715ea3e";var $=N,D=Object(n["withScopeId"])("data-v-75b3246b");Object(n["pushScopeId"])("data-v-75b3246b");var x={class:"future-weather-info-item"},T=Object(n["createTextVNode"])(" | "),P={class:"item-right"};Object(n["popScopeId"])();var A=D((function(e,t,o,r,a,c){var i=Object(n["resolveComponent"])("weather-icon");return Object(n["openBlock"])(),Object(n["createBlock"])("div",x,[Object(n["createVNode"])(i,{icon:o.dayIcon},null,8,["icon"]),T,Object(n["createVNode"])(i,{icon:o.nightIcon},null,8,["icon"]),Object(n["createVNode"])("div",null,Object(n["toDisplayString"])(o.text),1),Object(n["createVNode"])("div",P,Object(n["toDisplayString"])(o.maxTemp)+"° / "+Object(n["toDisplayString"])(o.minTemp)+"°",1)])})),L=Object(n["withScopeId"])("data-v-f0dbfb8c");Object(n["pushScopeId"])("data-v-f0dbfb8c");var B={ref:"box",class:"weather-icon"};Object(n["popScopeId"])();var V=L((function(e,t,o,r,a,c){return Object(n["openBlock"])(),Object(n["createBlock"])("div",B,null,512)})),_={name:"WeatherIcon",props:{icon:String},watch:{icon:function(e){this.setIcon(e)}},mounted:function(){this.setIcon(this.icon)},methods:{setIcon:function(e){this.$refs.box.style='background-image:url("'.concat(window.location.origin+"/SmogDetecter/"+this.$route.path,"weather_icons/64/").concat(e,'.png");')}}};o("794e");_.render=V,_.__scopeId="data-v-f0dbfb8c";var H=_,F={components:{WeatherIcon:H},name:"FutureWeatherInfoItem",props:{text:String,maxTemp:String,minTemp:String,dayIcon:String,nightIcon:String},methods:{}};o("3a80");F.render=A,F.__scopeId="data-v-75b3246b";var E=F,q={name:"Home",components:{"city-component":$,"future-weather-info-item":E,"weather-icon":H},data:function(){return{weather:{feelsLike:"13",text:"神秘天气"},air:{aqi:3,category:"还行"},futureInfo:[]}},computed:{locationPos:function(){return this.$store.state.location}},watch:{locationPos:function(e){null!=e&&(this.getCurrentCityWeatherInfo(e),this.getCurrentCityAirInfo(e),this.getFutureInfo(e))}},mounted:function(){this.$store.state.homeWeatherInfo&&(this.weather=this.$store.state.homeWeatherInfo),this.$store.state.homeAirInfo&&(this.air=this.$store.state.homeAirInfo),this.$store.state.homeFutureInfo&&(this.futureInfo=this.$store.state.homeFutureInfo)},methods:{getCurrentCityWeatherInfo:function(e){var t=this;Object(C["a"])("https://devapi.qweather.com/v7/weather/now",{key:this.$store.state.key,location:e}).then((function(e){t.weather=e.now,t.$store.commit("setHomeData",{weather:t.weather})})).catch((function(e){console.error("Can't get current city weather info."+e),t.$message({message:"无法获取当前的天气信息。"+e,type:"error",duration:1e4,showClose:!0}),t.weather.feelsLike="NA",t.weather.text="Unknown",t.$store.commit("setHomeData",{weather:t.weather})}))},getCurrentCityAirInfo:function(e){var t=this;Object(C["a"])("https://devapi.qweather.com/v7/air/now",{key:this.$store.state.key,location:e}).then((function(e){t.air=e.now,t.$store.commit("setHomeData",{air:t.air})})).catch((function(e){console.error("Can't get current city air info."+e),t.$message({message:"无法获取当前空气质量信息。"+e,type:"error",duration:1e4,showClose:!0}),t.air.aqi="NA",t.air.category="Unknown",t.$store.commit("setHomeData",{air:t.air})}))},dateToString:function(e){var t=String(e.getMonth()+1);1===t.length&&(t="0"+t);var o=String(e.getDate());return 1===o.length&&(o="0"+o),e.getFullYear()+"-"+t+"-"+o},getFutureInfo:function(e){var t=new Date,o=this.dateToString(t);t.setDate(t.getDate()+1);var n=this.dateToString(t);t.setDate(t.getDate()+1);var r=this.dateToString(t),a={};a[o]="今天",a[n]="明天",a[r]="后天";var c=this;Object(C["a"])("https://devapi.qweather.com/v7/weather/3d",{key:this.$store.state.key,location:e}).then((function(e){var t,o=[],n=Object(j["a"])(e.daily);try{for(n.s();!(t=n.n()).done;){var r=t.value;o.push({text:a[r.fxDate]+" · "+r.textDay+"/"+r.textNight,maxTemp:r.tempMax,minTemp:r.tempMin,dayIcon:r.iconDay,nightIcon:r.iconNight})}}catch(i){n.e(i)}finally{n.f()}c.futureInfo=o,c.$store.commit("setHomeData",{futureInfo:c.futureInfo})})).catch((function(e){console.error("Can't get future weather info."+e),c.$message({message:"无法获取未来天气预报信息。"+e,type:"error",duration:1e4,showClose:!0}),c.futureInfo=[],c.$store.commit("setHomeData",{futureInfo:c.futureInfo})}))}}};o("7bc5");q.render=O,q.__scopeId="data-v-afe3d07a";var W=q,R=[{path:"/",name:"Home",component:W},{path:"/info",name:"WeatherInfo",component:function(){return o.e("chunk-120fab18").then(o.bind(null,"5011"))}}],M=Object(i["a"])({history:Object(i["b"])("/SmogDetecter/"),routes:R}),U=M,J=o("5502"),X=Object(J["a"])({state:{key:"215e1f6839c547e1ae69f1a88aefd915",locationPos:null,location:"",cityInfo:null,homeWeatherInfo:null,homeAirInfo:null,homeFutureInfo:null},mutations:{setLocation:function(e,t){e.location=t},setLocationPos:function(e,t){e.locationPos=t},setCityInfo:function(e,t){e.cityInfo=t},clearCityInfo:function(e){e.cityInfo=null},setHomeData:function(e,t){e.homeWeatherInfo=void 0!==t.weather?t.weather:e.homeWeatherInfo,e.homeAirInfo=void 0!==t.air?t.air:e.homeAirInfo,e.homeFutureInfo=void 0!==t.futureInfo?t.futureInfo:e.homeFutureInfo},clearHomeData:function(e){e.homeWeatherInfo=null,e.homeAirInfo=null,e.homeFutureInfo=null}},actions:{},modules:{}}),G=(o("7f17"),o("f3fc"),o("6573")),K=o.n(G),Y=(o("4af4"),o("44fb")),z=o.n(Y),Q=o("3ef0"),Z=o.n(Q),ee=o("51d4"),te=o.n(ee),oe=function(e){te.a.use(Z.a),e.use(z.a),e.use(K.a)},ne=Object(n["createApp"])(c);oe(ne),ne.use(X).use(U).mount("#app")},"58f3":function(e,t,o){"use strict";o("9aaf")},"794e":function(e,t,o){"use strict";o("79e4")},"79aa":function(e,t,o){},"79e4":function(e,t,o){},"7bc5":function(e,t,o){"use strict";o("31a8")},"9aaf":function(e,t,o){},bf5e:function(e,t,o){"use strict";o("cc9a")},cc9a:function(e,t,o){}});
//# sourceMappingURL=app.87a0f418.js.map